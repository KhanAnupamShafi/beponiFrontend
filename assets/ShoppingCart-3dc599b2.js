import{r as M,o as U,K as F,Q as R,j as n,a as e,t as v,V as G,L as O,M as H,P as K,W as V,u as W,d as X,h as Y,X as J,c as Z,k as ee}from"./index-8206ae57.js";function ae({product:a,user:l}){var h,b,g,x,N,p;const[P,E]=M.useState(1),[S,{isSuccess:t,isError:d,error:u,isLoading:D}]=U(),[T,{isError:q,isLoading:L,isSuccess:$,error:z}]=F(),[A,{isSuccess:o,isError:_,error:I,isLoading:y}]=R(),f=s=>{if(l!=null&&l.email){console.log("if");const i=l==null?void 0:l.email;T({productId:{productId:s},userEmail:i})}else console.log("else"),V(s)},k=(s,i)=>{const r=l==null?void 0:l.email;S({email:r,data:{product:s}})},w=(s,i)=>{const r=l==null?void 0:l.email;A({email:r,data:{minusQty:i,product:s}})},C=s=>{let i=s.target.valueAsNumber,{min:r,max:m}=s.target;i=Math.max(Number(r),Math.min(Number(m),Number(i))),E(i)};return n("tr",{className:"block lg:table-row text-[#333]",children:[e("td",{className:"block mx-auto lg:table-cell w-auto lg:w-[100px]",children:e("div",{className:"max-w-[300px] lg:max-w-[100px] w-full mx-auto relative text-center",children:n("div",{className:"indicator",children:[L?e("button",{type:"button",className:"indicator-item border-opacity-5 rounded-lg shadow-lg cursor-pointer h-5 w-5",disabled:!0,children:e(v,{className:"animate-spin",size:15})}):e("button",{disabled:L,onClick:()=>{var s;return f((s=a==null?void 0:a.product)==null?void 0:s._id)},className:"indicator-item border-opacity-5 rounded-lg bg-white shadow-lg cursor-pointer",children:e(G,{size:20})}),e("figure",{className:"product-media",children:e(O,{to:`/product-details/${(h=a==null?void 0:a.product)==null?void 0:h._id}`,children:e("img",{className:"max-w-full lg:max-w-[100px] h-[100px] object-cover",src:(g=(b=a==null?void 0:a.product)==null?void 0:b.images)==null?void 0:g[0],alt:"product"})})})]})})}),e("td",{className:"text-center text-lg lg:text-sm font-normal lg:font-bold block lg:table-cell py-0 pb-2.5",children:(x=a==null?void 0:a.product)==null?void 0:x.name}),n("td",{className:"text-center lg:text-base font-semibold block lg:table-cell py-0 pb-2.5",children:["$",(N=a==null?void 0:a.product)==null?void 0:N.price,".00"]}),e("td",{className:"block lg:table-cell mx-auto text-center py-0 pb-2.5",children:n("div",{className:"text-center inline-flex w-full max-w-[120px] relative h-[44px]",children:[e("input",{className:"flex-1 relative px-4 border input rounded-sm border-[#ccc] focus:outline-none",type:"number",min:1,max:5,value:a==null?void 0:a.quantity,onChange:C}),n("div",{className:"absolute space-x-2 top-1/2 -translate-y-2/4 right-2",children:[y?e("button",{type:"button",className:" items-center text-gray-600 hover:text-gray-700  outline-none border-transparent",disabled:!0,children:e(v,{className:"animate-spin",color:"#336699",size:20})}):e("button",{className:"quantity-minus ",onClick:()=>{var s;return w((s=a==null?void 0:a.product)==null?void 0:s._id,(a==null?void 0:a.quantity)-1)},disabled:(a==null?void 0:a.quantity)===1,children:e(H,{className:"bg-[#eee] hover:text-[#ff4747] transition-colors rounded-full",color:"#666",size:20})}),D?e("button",{type:"button",className:" items-center text-gray-600 hover:text-gray-700  outline-none border-transparent",disabled:!0,children:e(v,{className:"animate-spin",color:"#336699",size:20})}):e("button",{className:"quantity-plus",onClick:()=>{var s;return k((s=a==null?void 0:a.product)==null?void 0:s._id,(a==null?void 0:a.quantity)+1)},children:e(K,{className:"bg-[#eee] hover:text-[#ff4747] transition-colors rounded-full",color:"#666",size:20})})]})]})}),e("td",{className:"block lg:table-cell mx-auto text-center py-0 pb-2.5",children:n("p",{className:"text-lg font-semibold text-center text-sky-700",children:["$",((p=a==null?void 0:a.product)==null?void 0:p.price)*(a==null?void 0:a.quantity),".00"]})})]},a==null?void 0:a._id)}const te=()=>{var I,y,f,k,w,C,h,b,g,x,N,p,s,i,r,m,j,B,Q;const a=W(),{user:l}=X(c=>c==null?void 0:c.user),[P,E]=M.useState(!0),S={email:l==null?void 0:l.email},{data:t,isLoading:d,isError:u}=Y(S,{skip:P});console.log((f=(y=(I=t==null?void 0:t.data)==null?void 0:I.cartData)==null?void 0:y.products)==null?void 0:f.length,"_____");const[D,{isError:T,isLoading:q,isSuccess:L,error:$}]=J(),z=()=>{const c=l==null?void 0:l.email;D({userEmail:c})},A=()=>{a(Z(!1))};M.useEffect(()=>{l&&E(!1)},[l]);let o=null;d&&(o=e(ee,{})),!d&&u&&(o=e("p",{className:"text-danger",children:"Something was wrong!"})),!d&&!u&&((C=(w=(k=t==null?void 0:t.data)==null?void 0:k.cartData)==null?void 0:w.products)==null?void 0:C.length)===0&&(o=e("p",{className:"text-danger",children:"Your cart is empty"})),!d&&!u&&((g=(b=(h=t==null?void 0:t.data)==null?void 0:h.cartData)==null?void 0:b.products)==null?void 0:g.length)>0&&(o=(p=(N=(x=t==null?void 0:t.data)==null?void 0:x.cartData)==null?void 0:N.products)==null?void 0:p.map(c=>e(ae,{product:c,user:l},c==null?void 0:c._id)));const _="pointer-events-none opacity-30";return n("div",{children:[e("section",{className:"w-full lg:h-40  text-center py-5 lg:pt-14 text-xl lg:text-4xl font-bold",children:e("p",{children:"Shopping Cart"})}),n("div",{className:"container grid grid-cols-9 pb-5",children:[n("div",{className:"col-span-9 xl:col-span-6 px-4 w-full ",children:[n("table",{className:"table w-full collapse z-0",children:[e("thead",{className:"hidden lg:table-header-group",children:n("tr",{className:"bg-none",children:[e("th",{className:"capitalize text-base bg-none",children:"Product"}),e("th",{className:"capitalize text-base bg-none",children:"Product Name"}),e("th",{className:"capitalize text-base bg-none",children:"Price"}),e("th",{className:"capitalize text-base bg-none",children:"Quantity"}),e("th",{className:"capitalize text-base bg-none",children:"Subtotal"})]})}),e("tbody",{className:"block lg:table-row-group border border-[#eee] lg:py-0 py-5 lg:border-none",children:o})]}),e("hr",{}),n("div",{className:"py-4 mb-7 flex flex-wrap gap-4 lg:gap-0 w-full justify-between items-center",children:[e(O,{onClick:A,to:"/checkout",className:`btn btn-block lg:btn-wide lg:btn-md rounded bg-black text-white lg:text-sm text-xs  lg:font-semibold ${!((r=(i=(s=t==null?void 0:t.data)==null?void 0:s.cartData)==null?void 0:i.products)!=null&&r.length)&&_}`,children:e("span",{className:"",children:"CONTINUE SHOPPING"})}),e("div",{className:"flex justify-betweencommit items-center gap-3",children:q?n("button",{onClick:z,className:"btn btn-outline lg:btn-md rounded px-5 lg:text-sm text-xs lg:font-semibold ",children:[e("span",{children:"Deleting..."}),e(v,{className:"animate-spin",size:15})]}):e("button",{onClick:z,className:`btn btn-outline lg:btn-md rounded px-5 lg:text-sm text-xs lg:font-semibold ${!((B=(j=(m=t==null?void 0:t.data)==null?void 0:m.cartData)==null?void 0:j.products)!=null&&B.length)&&_}`,children:"CLEAR CART"})})]}),n("div",{className:"py-[1rem]",children:[e("h1",{className:"font-semibold text-xl py-2",children:"COUPON DISCOUNT"}),e("input",{className:"border-none w-full h-2 py-[1.3rem] focus:outline-none px-2",type:"text",name:"",id:"",placeholder:"Enter coupon code here..."}),e("hr",{})]})]}),n("div",{className:"col-span-9 lg:col-span-3 px-4 w-full pl-5",children:[e("h2",{className:"text-xl font-bold",children:"CART TOTALS"}),e("br",{}),n("div",{className:"flex justify-between pb-5",children:[e("h1",{children:"Subtotal"}),n("h1",{className:"pl-[14rem] font-bold",children:["à§³ ",(Q=t==null?void 0:t.data)==null?void 0:Q.subtotal]})]}),e("hr",{}),n("div",{className:"my-4",children:[e("h1",{className:"font-bold",children:"Shipping"}),n("div",{className:"flex gap-2 my-1",children:[e("input",{type:"checkbox",checked:!0,className:"checkbox checkbox-xs mt-[.3rem]"}),e("p",{children:"Free Shipping"})]}),n("div",{className:"flex gap-2 my-1",children:[e("input",{type:"checkbox",checked:!0,className:"checkbox checkbox-xs mt-[.3rem]"}),e("p",{children:"Local Pickup"})]}),n("div",{className:"flex gap-2 my-1",children:[e("input",{type:"checkbox",checked:!0,className:"checkbox checkbox-xs mt-[.3rem]"}),e("p",{children:"Flat rate: $5.00"})]}),n("h1",{children:["Shipping to ",e("span",{className:"font-bold",children:"CA"})]})]})]})]})]})};export{te as default};
